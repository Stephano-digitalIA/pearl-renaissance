import { createContext, useContext, useState, useEffect, ReactNode } from 'react';

export type Locale = 'fr' | 'en' | 'es' | 'de' | 'ja' | 'it' | 'pt' | 'nl';
export type Currency = 'XPF' | 'EUR' | 'USD';

interface LocaleConfig {
  locale: Locale;
  currency: Currency;
  currencySymbol: string;
  exchangeRate: number; // relative to XPF
}

const localeConfigs: Record<string, LocaleConfig> = {
  // French Polynesia (default)
  PF: { locale: 'fr', currency: 'XPF', currencySymbol: 'XPF', exchangeRate: 1 },
  // European countries - EUR
  FR: { locale: 'fr', currency: 'EUR', currencySymbol: '€', exchangeRate: 0.00838 },
  ES: { locale: 'es', currency: 'EUR', currencySymbol: '€', exchangeRate: 0.00838 },
  DE: { locale: 'de', currency: 'EUR', currencySymbol: '€', exchangeRate: 0.00838 },
  AT: { locale: 'de', currency: 'EUR', currencySymbol: '€', exchangeRate: 0.00838 },
  CH: { locale: 'de', currency: 'EUR', currencySymbol: '€', exchangeRate: 0.00838 },
  IT: { locale: 'it', currency: 'EUR', currencySymbol: '€', exchangeRate: 0.00838 },
  PT: { locale: 'pt', currency: 'EUR', currencySymbol: '€', exchangeRate: 0.00838 },
  NL: { locale: 'nl', currency: 'EUR', currencySymbol: '€', exchangeRate: 0.00838 },
  BE: { locale: 'nl', currency: 'EUR', currencySymbol: '€', exchangeRate: 0.00838 },
  GB: { locale: 'en', currency: 'EUR', currencySymbol: '€', exchangeRate: 0.00838 },
  IE: { locale: 'en', currency: 'EUR', currencySymbol: '€', exchangeRate: 0.00838 },
  GR: { locale: 'en', currency: 'EUR', currencySymbol: '€', exchangeRate: 0.00838 },
  FI: { locale: 'en', currency: 'EUR', currencySymbol: '€', exchangeRate: 0.00838 },
  SE: { locale: 'en', currency: 'EUR', currencySymbol: '€', exchangeRate: 0.00838 },
  DK: { locale: 'en', currency: 'EUR', currencySymbol: '€', exchangeRate: 0.00838 },
  NO: { locale: 'en', currency: 'EUR', currencySymbol: '€', exchangeRate: 0.00838 },
  PL: { locale: 'en', currency: 'EUR', currencySymbol: '€', exchangeRate: 0.00838 },
  CZ: { locale: 'en', currency: 'EUR', currencySymbol: '€', exchangeRate: 0.00838 },
  HU: { locale: 'en', currency: 'EUR', currencySymbol: '€', exchangeRate: 0.00838 },
  RO: { locale: 'en', currency: 'EUR', currencySymbol: '€', exchangeRate: 0.00838 },
  BG: { locale: 'en', currency: 'EUR', currencySymbol: '€', exchangeRate: 0.00838 },
  HR: { locale: 'en', currency: 'EUR', currencySymbol: '€', exchangeRate: 0.00838 },
  SK: { locale: 'en', currency: 'EUR', currencySymbol: '€', exchangeRate: 0.00838 },
  SI: { locale: 'en', currency: 'EUR', currencySymbol: '€', exchangeRate: 0.00838 },
  LU: { locale: 'fr', currency: 'EUR', currencySymbol: '€', exchangeRate: 0.00838 },
  MC: { locale: 'fr', currency: 'EUR', currencySymbol: '€', exchangeRate: 0.00838 },
  // Rest of the world - USD
  US: { locale: 'en', currency: 'USD', currencySymbol: '$', exchangeRate: 0.0091 },
  CA: { locale: 'en', currency: 'USD', currencySymbol: '$', exchangeRate: 0.0091 },
  JP: { locale: 'ja', currency: 'USD', currencySymbol: '$', exchangeRate: 0.0091 },
  BR: { locale: 'pt', currency: 'USD', currencySymbol: '$', exchangeRate: 0.0091 },
  MX: { locale: 'es', currency: 'USD', currencySymbol: '$', exchangeRate: 0.0091 },
  AR: { locale: 'es', currency: 'USD', currencySymbol: '$', exchangeRate: 0.0091 },
  AU: { locale: 'en', currency: 'USD', currencySymbol: '$', exchangeRate: 0.0091 },
  NZ: { locale: 'en', currency: 'USD', currencySymbol: '$', exchangeRate: 0.0091 },
  CN: { locale: 'en', currency: 'USD', currencySymbol: '$', exchangeRate: 0.0091 },
  KR: { locale: 'en', currency: 'USD', currencySymbol: '$', exchangeRate: 0.0091 },
  // Default fallback - USD for rest of world
  default: { locale: 'en', currency: 'USD', currencySymbol: '$', exchangeRate: 0.0091 },
};

interface LocaleContextType {
  locale: Locale;
  setLocale: (locale: Locale) => void;
  currency: Currency;
  currencySymbol: string;
  formatPrice: (priceXPF: number) => string;
  t: (key: string) => string;
  countryCode: string;
}

const LocaleContext = createContext<LocaleContextType | undefined>(undefined);

// Translations
const translations: Record<Locale, Record<string, string>> = {
  fr: {
    'nav.collections': 'Collections',
    'nav.story': "L'Histoire",
    'nav.workshop': "L'Atelier",
    'nav.cart': 'Panier',
    'hero.tagline': 'Authenticité & Luxe',
    'hero.title': "L'Élégance née des",
    'hero.titleAccent': 'Profondeurs',
    'hero.description': 'Découvrez la magie des perles noires de Tahiti, cultivées avec passion dans les eaux cristallines de Polynésie.',
    'hero.cta': 'Explorer la Collection',
    'hero.discover': 'Découvrir',
    'collections.tagline': 'Nos Créations',
    'collections.title': 'Les Collections',
    'collections.all': 'Tous',
    'collections.addToCart': 'Ajouter au panier',
    'category.Colliers': 'Colliers',
    'category.Boucles d\'oreilles': "Boucles d'oreilles",
    'category.Bracelets': 'Bracelets',
    'category.Bagues': 'Bagues',
    'story.tagline': 'Notre Histoire',
    'story.title': "L'Art de la Perle",
    'story.p1': "Depuis trois générations, notre famille cultive les perles noires dans les lagons préservés des Tuamotu. Chaque perle est le fruit d'un savoir-faire transmis et d'une passion pour l'excellence.",
    'story.p2': "Nos artisans sélectionnent minutieusement chaque perle pour créer des bijoux d'exception, alliant tradition polynésienne et design contemporain.",
    'story.cta': 'Découvrir notre atelier',
    'testimonials.tagline': 'Témoignages',
    'testimonials.title': 'Ce Que Disent Nos Clientes',
    'newsletter.tagline': 'Newsletter',
    'newsletter.title': 'Restez Informée',
    'newsletter.description': 'Recevez en avant-première nos nouvelles collections et offres exclusives.',
    'newsletter.placeholder': 'Votre email',
    'newsletter.cta': "S'inscrire",
    'newsletter.success': 'Merci pour votre inscription !',
    'footer.rights': 'Tous droits réservés',
    'footer.contact': 'Contact',
    'footer.legal': 'Mentions légales',
    'footer.privacy': 'Confidentialité',
    'cart.title': 'Votre Panier',
    'cart.empty': 'Votre panier est vide',
    'cart.total': 'Total',
    'cart.checkout': 'Commander',
    'cart.remove': 'Retirer',
    'shipping.title': 'Livraison & Services',
    'shipping.worldwide': 'Livraison Mondiale',
    'shipping.worldwideDesc': 'Expédition sécurisée partout dans le monde',
    'shipping.certificate': "Certificat d'Authenticité",
    'shipping.certificateDesc': 'Chaque bijou accompagné de son certificat',
    'shipping.packaging': 'Écrin de Luxe',
    'shipping.packagingDesc': 'Présentation soignée dans un écrin premium',
    'shipping.baseFee': 'Frais de base',
    'shipping.estDelivery': 'Délai estimé',
    'shipping.yourZone': 'Votre zone',
    'shipping.free': 'Gratuit',
    'shipping.note': '* Les frais peuvent varier selon le poids et les dimensions du colis. Livraison gratuite en Polynésie Française.',
    'location.detected': 'Livraison vers',
    'location.shipping': 'Frais de port estimés',
    'manager.title': 'Gestion du Catalogue',
    'manager.add': 'Ajouter un produit',
    'manager.reset': 'Réinitialiser',
    'manager.image': 'Image',
    'manager.name': 'Nom',
    'manager.category': 'Catégorie',
    'manager.price': 'Prix',
    'manager.actions': 'Actions',
    'form.addTitle': 'Ajouter un produit',
    'form.editTitle': 'Modifier le produit',
    'form.productName': 'Nom du produit',
    'form.productNamePlaceholder': 'Ex: Larme du Lagon',
    'form.category': 'Catégorie',
    'form.price': 'Prix',
    'form.image': 'Image du produit',
    'form.upload': 'Upload',
    'form.url': 'URL',
    'form.uploadHint': 'Cliquez pour sélectionner une image',
    'form.maxSize': 'Max 6MB',
    'form.description': 'Description',
    'form.descriptionPlaceholder': 'Description du bijou...',
    'form.cancel': 'Annuler',
    'form.save': 'Enregistrer',
    'form.add': 'Ajouter',
    'form.imageRequired': 'Veuillez ajouter une image',
    'form.imageTypeError': 'Veuillez sélectionner une image',
    'form.imageSizeError': 'Image trop grande (max 6MB)',
    'form.storageError': 'Stockage du navigateur saturé. Essayez une image plus légère.',
    'form.genericError': "Impossible d'ajouter le produit. Réessayez.",
    'form.added': 'Produit ajouté avec succès',
    'form.updated': 'Produit modifié',
    'form.deleted': 'Produit supprimé',
    'form.resetConfirm': 'Réinitialiser le catalogue ?',
    'form.resetDone': 'Catalogue réinitialisé',
    'form.deleteConfirm': 'Supprimer ce produit ?',
    'product.1.description': 'Pendentif perle de Tahiti solitaire, 10mm, montée sur or blanc 18k.',
    'product.2.description': 'Paire de perles baroques aux reflets aubergine, crochets or jaune.',
    'product.3.description': 'Bracelet cuir et perles multiples, fermoir en argent massif.',
    'product.4.description': 'Perle noire parfaite de 11mm sur anneau pavé de diamants.',
    'product.5.description': 'Rang de perles multicolores (gris, vert, paon), fermoir invisible.',
    'product.6.description': 'Perles Keshi dorées, design minimaliste et moderne.',
  },
  en: {
    'nav.collections': 'Collections',
    'nav.story': 'Our Story',
    'nav.workshop': 'Workshop',
    'nav.cart': 'Cart',
    'hero.tagline': 'Authenticity & Luxury',
    'hero.title': 'Elegance Born from the',
    'hero.titleAccent': 'Depths',
    'hero.description': 'Discover the magic of Tahitian black pearls, cultivated with passion in the crystal-clear waters of Polynesia.',
    'hero.cta': 'Explore the Collection',
    'hero.discover': 'Discover',
    'collections.tagline': 'Our Creations',
    'collections.title': 'The Collections',
    'collections.all': 'All',
    'collections.addToCart': 'Add to Cart',
    'category.Colliers': 'Necklaces',
    'category.Boucles d\'oreilles': 'Earrings',
    'category.Bracelets': 'Bracelets',
    'category.Bagues': 'Rings',
    'story.tagline': 'Our Story',
    'story.title': 'The Art of the Pearl',
    'story.p1': 'For three generations, our family has cultivated black pearls in the preserved lagoons of the Tuamotu. Each pearl is the fruit of transmitted expertise and a passion for excellence.',
    'story.p2': 'Our artisans meticulously select each pearl to create exceptional jewelry, combining Polynesian tradition with contemporary design.',
    'story.cta': 'Discover our workshop',
    'testimonials.tagline': 'Testimonials',
    'testimonials.title': 'What Our Customers Say',
    'newsletter.tagline': 'Newsletter',
    'newsletter.title': 'Stay Informed',
    'newsletter.description': 'Be the first to receive our new collections and exclusive offers.',
    'newsletter.placeholder': 'Your email',
    'newsletter.cta': 'Subscribe',
    'newsletter.success': 'Thank you for subscribing!',
    'footer.rights': 'All rights reserved',
    'footer.contact': 'Contact',
    'footer.legal': 'Legal Notice',
    'footer.privacy': 'Privacy',
    'cart.title': 'Your Cart',
    'cart.empty': 'Your cart is empty',
    'cart.total': 'Total',
    'cart.checkout': 'Checkout',
    'cart.remove': 'Remove',
    'shipping.title': 'Shipping & Services',
    'shipping.worldwide': 'Worldwide Shipping',
    'shipping.worldwideDesc': 'Secure shipping worldwide',
    'shipping.certificate': 'Certificate of Authenticity',
    'shipping.certificateDesc': 'Each piece comes with its certificate',
    'shipping.packaging': 'Luxury Packaging',
    'shipping.packagingDesc': 'Elegant presentation in a premium case',
    'shipping.baseFee': 'Base fee',
    'shipping.estDelivery': 'Est. delivery',
    'shipping.yourZone': 'Your zone',
    'shipping.free': 'Free',
    'shipping.note': '* Fees may vary depending on weight and dimensions. Free shipping in French Polynesia.',
    'location.detected': 'Shipping to',
    'location.shipping': 'Estimated shipping',
    'manager.title': 'Catalog Management',
    'manager.add': 'Add a product',
    'manager.reset': 'Reset',
    'manager.image': 'Image',
    'manager.name': 'Name',
    'manager.category': 'Category',
    'manager.price': 'Price',
    'manager.actions': 'Actions',
    'form.addTitle': 'Add a product',
    'form.editTitle': 'Edit product',
    'form.productName': 'Product name',
    'form.productNamePlaceholder': 'Ex: Lagoon Tear',
    'form.category': 'Category',
    'form.price': 'Price',
    'form.image': 'Product image',
    'form.upload': 'Upload',
    'form.url': 'URL',
    'form.uploadHint': 'Click to select an image',
    'form.maxSize': 'Max 6MB',
    'form.description': 'Description',
    'form.descriptionPlaceholder': 'Jewelry description...',
    'form.cancel': 'Cancel',
    'form.save': 'Save',
    'form.add': 'Add',
    'form.imageRequired': 'Please add an image',
    'form.imageTypeError': 'Please select an image',
    'form.imageSizeError': 'Image too large (max 6MB)',
    'form.storageError': 'Browser storage full. Try a lighter image.',
    'form.genericError': 'Unable to add product. Please retry.',
    'form.added': 'Product added successfully',
    'form.updated': 'Product updated',
    'form.deleted': 'Product deleted',
    'form.resetConfirm': 'Reset catalog?',
    'form.resetDone': 'Catalog reset',
    'form.deleteConfirm': 'Delete this product?',
    'product.1.description': 'Solitaire Tahitian pearl pendant, 10mm, set in 18k white gold.',
    'product.2.description': 'Pair of baroque pearls with aubergine reflections, yellow gold hooks.',
    'product.3.description': 'Leather bracelet with multiple pearls, solid silver clasp.',
    'product.4.description': 'Perfect 11mm black pearl on diamond-pavé ring.',
    'product.5.description': 'Strand of multicolored pearls (gray, green, peacock), invisible clasp.',
    'product.6.description': 'Golden Keshi pearls, minimalist and modern design.',
  },
  es: {
    'nav.collections': 'Colecciones',
    'nav.story': 'Nuestra Historia',
    'nav.workshop': 'Taller',
    'nav.cart': 'Carrito',
    'hero.tagline': 'Autenticidad y Lujo',
    'hero.title': 'Elegancia Nacida de las',
    'hero.titleAccent': 'Profundidades',
    'hero.description': 'Descubra la magia de las perlas negras de Tahití, cultivadas con pasión en las aguas cristalinas de la Polinesia.',
    'hero.cta': 'Explorar la Colección',
    'hero.discover': 'Descubrir',
    'collections.tagline': 'Nuestras Creaciones',
    'collections.title': 'Las Colecciones',
    'collections.all': 'Todos',
    'collections.addToCart': 'Añadir al carrito',
    'category.Colliers': 'Collares',
    'category.Boucles d\'oreilles': 'Pendientes',
    'category.Bracelets': 'Pulseras',
    'category.Bagues': 'Anillos',
    'story.tagline': 'Nuestra Historia',
    'story.title': 'El Arte de la Perla',
    'story.p1': 'Durante tres generaciones, nuestra familia ha cultivado perlas negras en las lagunas preservadas de Tuamotu. Cada perla es el fruto de un saber hacer transmitido y una pasión por la excelencia.',
    'story.p2': 'Nuestros artesanos seleccionan meticulosamente cada perla para crear joyas excepcionales, combinando la tradición polinesia con el diseño contemporáneo.',
    'story.cta': 'Descubrir nuestro taller',
    'testimonials.tagline': 'Testimonios',
    'testimonials.title': 'Lo Que Dicen Nuestras Clientas',
    'newsletter.tagline': 'Boletín',
    'newsletter.title': 'Manténgase Informada',
    'newsletter.description': 'Sea la primera en recibir nuestras nuevas colecciones y ofertas exclusivas.',
    'newsletter.placeholder': 'Su email',
    'newsletter.cta': 'Suscribirse',
    'newsletter.success': '¡Gracias por suscribirse!',
    'footer.rights': 'Todos los derechos reservados',
    'footer.contact': 'Contacto',
    'footer.legal': 'Aviso Legal',
    'footer.privacy': 'Privacidad',
    'cart.title': 'Su Carrito',
    'cart.empty': 'Su carrito está vacío',
    'cart.total': 'Total',
    'cart.checkout': 'Pagar',
    'cart.remove': 'Eliminar',
    'shipping.title': 'Envío y Servicios',
    'shipping.worldwide': 'Envío Mundial',
    'shipping.worldwideDesc': 'Envío seguro a todo el mundo',
    'shipping.certificate': 'Certificado de Autenticidad',
    'shipping.certificateDesc': 'Cada pieza viene con su certificado',
    'shipping.packaging': 'Embalaje de Lujo',
    'shipping.packagingDesc': 'Presentación elegante en estuche premium',
    'shipping.baseFee': 'Tarifa base',
    'shipping.estDelivery': 'Entrega est.',
    'shipping.yourZone': 'Su zona',
    'shipping.free': 'Gratis',
    'shipping.note': '* Las tarifas pueden variar según el peso y las dimensiones. Envío gratuito en la Polinesia Francesa.',
    'location.detected': 'Envío a',
    'location.shipping': 'Envío estimado',
    'manager.title': 'Gestión del Catálogo',
    'manager.add': 'Añadir producto',
    'manager.reset': 'Reiniciar',
    'manager.image': 'Imagen',
    'manager.name': 'Nombre',
    'manager.category': 'Categoría',
    'manager.price': 'Precio',
    'manager.actions': 'Acciones',
    'form.addTitle': 'Añadir producto',
    'form.editTitle': 'Editar producto',
    'form.productName': 'Nombre del producto',
    'form.productNamePlaceholder': 'Ej: Lágrima de la Laguna',
    'form.category': 'Categoría',
    'form.price': 'Precio',
    'form.image': 'Imagen del producto',
    'form.upload': 'Subir',
    'form.url': 'URL',
    'form.uploadHint': 'Haga clic para seleccionar una imagen',
    'form.maxSize': 'Máx 6MB',
    'form.description': 'Descripción',
    'form.descriptionPlaceholder': 'Descripción de la joya...',
    'form.cancel': 'Cancelar',
    'form.save': 'Guardar',
    'form.add': 'Añadir',
    'form.imageRequired': 'Por favor añada una imagen',
    'form.imageTypeError': 'Por favor seleccione una imagen',
    'form.imageSizeError': 'Imagen demasiado grande (máx 6MB)',
    'form.storageError': 'Almacenamiento lleno. Pruebe con una imagen más ligera.',
    'form.genericError': 'No se pudo añadir el producto. Inténtelo de nuevo.',
    'form.added': 'Producto añadido correctamente',
    'form.updated': 'Producto actualizado',
    'form.deleted': 'Producto eliminado',
    'form.resetConfirm': '¿Reiniciar catálogo?',
    'form.resetDone': 'Catálogo reiniciado',
    'form.deleteConfirm': '¿Eliminar este producto?',
    'product.1.description': 'Colgante de perla de Tahití solitaria, 10mm, montada en oro blanco de 18k.',
    'product.2.description': 'Par de perlas barrocas con reflejos berenjena, ganchos de oro amarillo.',
    'product.3.description': 'Pulsera de cuero con múltiples perlas, cierre de plata maciza.',
    'product.4.description': 'Perla negra perfecta de 11mm en anillo pavé de diamantes.',
    'product.5.description': 'Hilera de perlas multicolores (gris, verde, pavo real), cierre invisible.',
    'product.6.description': 'Perlas Keshi doradas, diseño minimalista y moderno.',
  },
  de: {
    'nav.collections': 'Kollektionen',
    'nav.story': 'Unsere Geschichte',
    'nav.workshop': 'Werkstatt',
    'nav.cart': 'Warenkorb',
    'hero.tagline': 'Authentizität & Luxus',
    'hero.title': 'Eleganz Geboren aus den',
    'hero.titleAccent': 'Tiefen',
    'hero.description': 'Entdecken Sie die Magie der schwarzen Tahiti-Perlen, mit Leidenschaft in den kristallklaren Gewässern Polynesiens kultiviert.',
    'hero.cta': 'Kollektion Entdecken',
    'hero.discover': 'Entdecken',
    'collections.tagline': 'Unsere Kreationen',
    'collections.title': 'Die Kollektionen',
    'collections.all': 'Alle',
    'collections.addToCart': 'In den Warenkorb',
    'category.Colliers': 'Halsketten',
    'category.Boucles d\'oreilles': 'Ohrringe',
    'category.Bracelets': 'Armbänder',
    'category.Bagues': 'Ringe',
    'story.tagline': 'Unsere Geschichte',
    'story.title': 'Die Kunst der Perle',
    'story.p1': 'Seit drei Generationen kultiviert unsere Familie schwarze Perlen in den geschützten Lagunen der Tuamotu. Jede Perle ist das Ergebnis überlieferten Könnens und einer Leidenschaft für Exzellenz.',
    'story.p2': 'Unsere Handwerker wählen jede Perle sorgfältig aus, um außergewöhnlichen Schmuck zu kreieren, der polynesische Tradition mit zeitgenössischem Design verbindet.',
    'story.cta': 'Unsere Werkstatt entdecken',
    'testimonials.tagline': 'Bewertungen',
    'testimonials.title': 'Was Unsere Kundinnen Sagen',
    'newsletter.tagline': 'Newsletter',
    'newsletter.title': 'Bleiben Sie Informiert',
    'newsletter.description': 'Erhalten Sie als Erste unsere neuen Kollektionen und exklusiven Angebote.',
    'newsletter.placeholder': 'Ihre E-Mail',
    'newsletter.cta': 'Abonnieren',
    'newsletter.success': 'Vielen Dank für Ihre Anmeldung!',
    'footer.rights': 'Alle Rechte vorbehalten',
    'footer.contact': 'Kontakt',
    'footer.legal': 'Impressum',
    'footer.privacy': 'Datenschutz',
    'cart.title': 'Ihr Warenkorb',
    'cart.empty': 'Ihr Warenkorb ist leer',
    'cart.total': 'Gesamt',
    'cart.checkout': 'Zur Kasse',
    'cart.remove': 'Entfernen',
    'shipping.title': 'Versand & Service',
    'shipping.worldwide': 'Weltweiter Versand',
    'shipping.worldwideDesc': 'Sicherer Versand weltweit',
    'shipping.certificate': 'Echtheitszertifikat',
    'shipping.certificateDesc': 'Jedes Stück mit Zertifikat',
    'shipping.packaging': 'Luxusverpackung',
    'shipping.packagingDesc': 'Elegante Präsentation in Premium-Etui',
    'shipping.baseFee': 'Grundgebühr',
    'shipping.estDelivery': 'Geschätzte Lieferung',
    'shipping.yourZone': 'Ihre Zone',
    'shipping.free': 'Kostenlos',
    'shipping.note': '* Gebühren können je nach Gewicht und Abmessungen variieren. Kostenloser Versand in Französisch-Polynesien.',
    'location.detected': 'Versand nach',
    'location.shipping': 'Geschätzte Versandkosten',
    'manager.title': 'Katalogverwaltung',
    'manager.add': 'Produkt hinzufügen',
    'manager.reset': 'Zurücksetzen',
    'manager.image': 'Bild',
    'manager.name': 'Name',
    'manager.category': 'Kategorie',
    'manager.price': 'Preis',
    'manager.actions': 'Aktionen',
    'form.addTitle': 'Produkt hinzufügen',
    'form.editTitle': 'Produkt bearbeiten',
    'form.productName': 'Produktname',
    'form.productNamePlaceholder': 'Z.B.: Lagunenträne',
    'form.category': 'Kategorie',
    'form.price': 'Preis',
    'form.image': 'Produktbild',
    'form.upload': 'Hochladen',
    'form.url': 'URL',
    'form.uploadHint': 'Klicken Sie, um ein Bild auszuwählen',
    'form.maxSize': 'Max 6MB',
    'form.description': 'Beschreibung',
    'form.descriptionPlaceholder': 'Schmuckbeschreibung...',
    'form.cancel': 'Abbrechen',
    'form.save': 'Speichern',
    'form.add': 'Hinzufügen',
    'form.imageRequired': 'Bitte fügen Sie ein Bild hinzu',
    'form.imageTypeError': 'Bitte wählen Sie ein Bild aus',
    'form.imageSizeError': 'Bild zu groß (max 6MB)',
    'form.storageError': 'Speicher voll. Versuchen Sie ein kleineres Bild.',
    'form.genericError': 'Produkt konnte nicht hinzugefügt werden. Bitte erneut versuchen.',
    'form.added': 'Produkt erfolgreich hinzugefügt',
    'form.updated': 'Produkt aktualisiert',
    'form.deleted': 'Produkt gelöscht',
    'form.resetConfirm': 'Katalog zurücksetzen?',
    'form.resetDone': 'Katalog zurückgesetzt',
    'form.deleteConfirm': 'Dieses Produkt löschen?',
    'product.1.description': 'Solitär Tahiti-Perlenanhänger, 10mm, gefasst in 18k Weißgold.',
    'product.2.description': 'Paar Barockperlen mit auberginefarbenen Reflexen, Gelbgoldhaken.',
    'product.3.description': 'Lederarmband mit mehreren Perlen, massiver Silberverschluss.',
    'product.4.description': 'Perfekte 11mm schwarze Perle auf diamantbesetztem Ring.',
    'product.5.description': 'Strang mehrfarbiger Perlen (grau, grün, Pfau), unsichtbarer Verschluss.',
    'product.6.description': 'Goldene Keshi-Perlen, minimalistisches und modernes Design.',
  },
  ja: {
    'nav.collections': 'コレクション',
    'nav.story': '私たちの物語',
    'nav.workshop': 'アトリエ',
    'nav.cart': 'カート',
    'hero.tagline': '本物と贅沢',
    'hero.title': '深海から生まれた',
    'hero.titleAccent': 'エレガンス',
    'hero.description': 'ポリネシアの透明な海で情熱を込めて育てられたタヒチ黒真珠の魔法をご覧ください。',
    'hero.cta': 'コレクションを見る',
    'hero.discover': '発見する',
    'collections.tagline': '私たちの作品',
    'collections.title': 'コレクション',
    'collections.all': 'すべて',
    'collections.addToCart': 'カートに追加',
    'category.Colliers': 'ネックレス',
    'category.Boucles d\'oreilles': 'イヤリング',
    'category.Bracelets': 'ブレスレット',
    'category.Bagues': '指輪',
    'story.tagline': '私たちの物語',
    'story.title': '真珠の芸術',
    'story.p1': '三世代にわたり、私たちの家族はツアモツの保護されたラグーンで黒真珠を育ててきました。各真珠は伝承された技術と卓越性への情熱の結晶です。',
    'story.p2': '私たちの職人は、ポリネシアの伝統と現代的なデザインを融合させた特別なジュエリーを作るために、各真珠を丁寧に選びます。',
    'story.cta': 'アトリエを見る',
    'testimonials.tagline': 'お客様の声',
    'testimonials.title': 'お客様からの評価',
    'newsletter.tagline': 'ニュースレター',
    'newsletter.title': '最新情報をお届け',
    'newsletter.description': '新しいコレクションや限定オファーをいち早くお届けします。',
    'newsletter.placeholder': 'メールアドレス',
    'newsletter.cta': '登録する',
    'newsletter.success': 'ご登録ありがとうございます！',
    'footer.rights': '全著作権所有',
    'footer.contact': 'お問い合わせ',
    'footer.legal': '法的情報',
    'footer.privacy': 'プライバシー',
    'cart.title': 'カート',
    'cart.empty': 'カートは空です',
    'cart.total': '合計',
    'cart.checkout': '購入手続き',
    'cart.remove': '削除',
    'shipping.title': '配送とサービス',
    'shipping.worldwide': '世界配送',
    'shipping.worldwideDesc': '世界中への安全な配送',
    'shipping.certificate': '鑑定書',
    'shipping.certificateDesc': '各作品に鑑定書付き',
    'shipping.packaging': '高級パッケージ',
    'shipping.packagingDesc': 'プレミアムケースでエレガントに',
    'shipping.baseFee': '基本料金',
    'shipping.estDelivery': '配送予定',
    'shipping.yourZone': 'お客様の地域',
    'shipping.free': '無料',
    'shipping.note': '* 料金は重量とサイズにより異なる場合があります。フランス領ポリネシアは送料無料。',
    'location.detected': '配送先',
    'location.shipping': '推定送料',
    'manager.title': 'カタログ管理',
    'manager.add': '商品を追加',
    'manager.reset': 'リセット',
    'manager.image': '画像',
    'manager.name': '名前',
    'manager.category': 'カテゴリー',
    'manager.price': '価格',
    'manager.actions': 'アクション',
    'form.addTitle': '商品を追加',
    'form.editTitle': '商品を編集',
    'form.productName': '商品名',
    'form.productNamePlaceholder': '例：ラグーンの涙',
    'form.category': 'カテゴリー',
    'form.price': '価格',
    'form.image': '商品画像',
    'form.upload': 'アップロード',
    'form.url': 'URL',
    'form.uploadHint': 'クリックして画像を選択',
    'form.maxSize': '最大6MB',
    'form.description': '説明',
    'form.descriptionPlaceholder': 'ジュエリーの説明...',
    'form.cancel': 'キャンセル',
    'form.save': '保存',
    'form.add': '追加',
    'form.imageRequired': '画像を追加してください',
    'form.imageTypeError': '画像を選択してください',
    'form.imageSizeError': '画像が大きすぎます（最大6MB）',
    'form.storageError': 'ストレージがいっぱいです。軽い画像をお試しください。',
    'form.genericError': '商品を追加できませんでした。もう一度お試しください。',
    'form.added': '商品が追加されました',
    'form.updated': '商品が更新されました',
    'form.deleted': '商品が削除されました',
    'form.resetConfirm': 'カタログをリセットしますか？',
    'form.resetDone': 'カタログがリセットされました',
    'form.deleteConfirm': 'この商品を削除しますか？',
    'product.1.description': 'タヒチ真珠ソリティアペンダント、10mm、18kホワイトゴールド。',
    'product.2.description': 'オーベルジーヌ色の反射を持つバロック真珠ペア、イエローゴールドフック。',
    'product.3.description': '複数の真珠を使用したレザーブレスレット、シルバークラスプ。',
    'product.4.description': 'ダイヤモンドパヴェリングに11mmの完璧な黒真珠。',
    'product.5.description': 'マルチカラー真珠のストランド（グレー、グリーン、ピーコック）、インビジブルクラスプ。',
    'product.6.description': 'ゴールデンケシ真珠、ミニマルでモダンなデザイン。',
  },
  it: {
    'nav.collections': 'Collezioni',
    'nav.story': 'La Nostra Storia',
    'nav.workshop': 'Laboratorio',
    'nav.cart': 'Carrello',
    'hero.tagline': 'Autenticità e Lusso',
    'hero.title': "Eleganza Nata dalle",
    'hero.titleAccent': 'Profondità',
    'hero.description': 'Scoprite la magia delle perle nere di Tahiti, coltivate con passione nelle acque cristalline della Polinesia.',
    'hero.cta': 'Esplora la Collezione',
    'hero.discover': 'Scopri',
    'collections.tagline': 'Le Nostre Creazioni',
    'collections.title': 'Le Collezioni',
    'collections.all': 'Tutti',
    'collections.addToCart': 'Aggiungi al carrello',
    'category.Colliers': 'Collane',
    'category.Boucles d\'oreilles': 'Orecchini',
    'category.Bracelets': 'Bracciali',
    'category.Bagues': 'Anelli',
    'story.tagline': 'La Nostra Storia',
    'story.title': "L'Arte della Perla",
    'story.p1': "Da tre generazioni, la nostra famiglia coltiva perle nere nelle lagune preservate di Tuamotu. Ogni perla è il frutto di un sapere trasmesso e di una passione per l'eccellenza.",
    'story.p2': 'I nostri artigiani selezionano meticolosamente ogni perla per creare gioielli eccezionali, combinando la tradizione polinesiana con il design contemporaneo.',
    'story.cta': 'Scopri il nostro laboratorio',
    'testimonials.tagline': 'Testimonianze',
    'testimonials.title': 'Cosa Dicono le Nostre Clienti',
    'newsletter.tagline': 'Newsletter',
    'newsletter.title': 'Resta Informata',
    'newsletter.description': 'Ricevi in anteprima le nostre nuove collezioni e offerte esclusive.',
    'newsletter.placeholder': 'La tua email',
    'newsletter.cta': 'Iscriviti',
    'newsletter.success': 'Grazie per la tua iscrizione!',
    'footer.rights': 'Tutti i diritti riservati',
    'footer.contact': 'Contatto',
    'footer.legal': 'Note Legali',
    'footer.privacy': 'Privacy',
    'cart.title': 'Il Tuo Carrello',
    'cart.empty': 'Il tuo carrello è vuoto',
    'cart.total': 'Totale',
    'cart.checkout': 'Acquista',
    'cart.remove': 'Rimuovi',
    'shipping.title': 'Spedizione e Servizi',
    'shipping.worldwide': 'Spedizione Mondiale',
    'shipping.worldwideDesc': 'Spedizione sicura in tutto il mondo',
    'shipping.certificate': 'Certificato di Autenticità',
    'shipping.certificateDesc': 'Ogni pezzo con il suo certificato',
    'shipping.packaging': 'Confezione di Lusso',
    'shipping.packagingDesc': 'Presentazione elegante in astuccio premium',
    'shipping.baseFee': 'Tariffa base',
    'shipping.estDelivery': 'Consegna stimata',
    'shipping.yourZone': 'La tua zona',
    'shipping.free': 'Gratuito',
    'shipping.note': '* Le tariffe possono variare in base al peso e alle dimensioni. Spedizione gratuita nella Polinesia Francese.',
    'location.detected': 'Spedizione verso',
    'location.shipping': 'Spedizione stimata',
    'manager.title': 'Gestione Catalogo',
    'manager.add': 'Aggiungi prodotto',
    'manager.reset': 'Ripristina',
    'manager.image': 'Immagine',
    'manager.name': 'Nome',
    'manager.category': 'Categoria',
    'manager.price': 'Prezzo',
    'manager.actions': 'Azioni',
    'form.addTitle': 'Aggiungi prodotto',
    'form.editTitle': 'Modifica prodotto',
    'form.productName': 'Nome prodotto',
    'form.productNamePlaceholder': 'Es: Lacrima della Laguna',
    'form.category': 'Categoria',
    'form.price': 'Prezzo',
    'form.image': 'Immagine prodotto',
    'form.upload': 'Carica',
    'form.url': 'URL',
    'form.uploadHint': "Clicca per selezionare un'immagine",
    'form.maxSize': 'Max 6MB',
    'form.description': 'Descrizione',
    'form.descriptionPlaceholder': 'Descrizione del gioiello...',
    'form.cancel': 'Annulla',
    'form.save': 'Salva',
    'form.add': 'Aggiungi',
    'form.imageRequired': "Aggiungi un'immagine",
    'form.imageTypeError': "Seleziona un'immagine",
    'form.imageSizeError': 'Immagine troppo grande (max 6MB)',
    'form.storageError': "Memoria piena. Prova con un'immagine più leggera.",
    'form.genericError': 'Impossibile aggiungere il prodotto. Riprova.',
    'form.added': 'Prodotto aggiunto con successo',
    'form.updated': 'Prodotto aggiornato',
    'form.deleted': 'Prodotto eliminato',
    'form.resetConfirm': 'Ripristinare il catalogo?',
    'form.resetDone': 'Catalogo ripristinato',
    'form.deleteConfirm': 'Eliminare questo prodotto?',
    'product.1.description': 'Ciondolo perla di Tahiti solitaria, 10mm, montato in oro bianco 18k.',
    'product.2.description': 'Coppia di perle barocche con riflessi melanzana, ganci in oro giallo.',
    'product.3.description': 'Bracciale in pelle con perle multiple, chiusura in argento massiccio.',
    'product.4.description': 'Perla nera perfetta da 11mm su anello pavé di diamanti.',
    'product.5.description': 'Filo di perle multicolori (grigio, verde, pavone), chiusura invisibile.',
    'product.6.description': 'Perle Keshi dorate, design minimalista e moderno.',
  },
  pt: {
    'nav.collections': 'Coleções',
    'nav.story': 'Nossa História',
    'nav.workshop': 'Ateliê',
    'nav.cart': 'Carrinho',
    'hero.tagline': 'Autenticidade e Luxo',
    'hero.title': 'Elegância Nascida das',
    'hero.titleAccent': 'Profundezas',
    'hero.description': 'Descubra a magia das pérolas negras do Taiti, cultivadas com paixão nas águas cristalinas da Polinésia.',
    'hero.cta': 'Explorar a Coleção',
    'hero.discover': 'Descobrir',
    'collections.tagline': 'Nossas Criações',
    'collections.title': 'As Coleções',
    'collections.all': 'Todos',
    'collections.addToCart': 'Adicionar ao carrinho',
    'category.Colliers': 'Colares',
    'category.Boucles d\'oreilles': 'Brincos',
    'category.Bracelets': 'Pulseiras',
    'category.Bagues': 'Anéis',
    'story.tagline': 'Nossa História',
    'story.title': 'A Arte da Pérola',
    'story.p1': 'Por três gerações, nossa família cultiva pérolas negras nas lagoas preservadas de Tuamotu. Cada pérola é o fruto de um saber-fazer transmitido e uma paixão pela excelência.',
    'story.p2': 'Nossos artesãos selecionam meticulosamente cada pérola para criar joias excepcionais, combinando a tradição polinésia com o design contemporâneo.',
    'story.cta': 'Descobrir nosso ateliê',
    'testimonials.tagline': 'Depoimentos',
    'testimonials.title': 'O Que Dizem Nossas Clientes',
    'newsletter.tagline': 'Newsletter',
    'newsletter.title': 'Fique Informada',
    'newsletter.description': 'Receba em primeira mão nossas novas coleções e ofertas exclusivas.',
    'newsletter.placeholder': 'Seu email',
    'newsletter.cta': 'Inscrever-se',
    'newsletter.success': 'Obrigado pela sua inscrição!',
    'footer.rights': 'Todos os direitos reservados',
    'footer.contact': 'Contato',
    'footer.legal': 'Aviso Legal',
    'footer.privacy': 'Privacidade',
    'cart.title': 'Seu Carrinho',
    'cart.empty': 'Seu carrinho está vazio',
    'cart.total': 'Total',
    'cart.checkout': 'Finalizar',
    'cart.remove': 'Remover',
    'shipping.title': 'Envio e Serviços',
    'shipping.worldwide': 'Envio Mundial',
    'shipping.worldwideDesc': 'Envio seguro para todo o mundo',
    'shipping.certificate': 'Certificado de Autenticidade',
    'shipping.certificateDesc': 'Cada peça com seu certificado',
    'shipping.packaging': 'Embalagem de Luxo',
    'shipping.packagingDesc': 'Apresentação elegante em estojo premium',
    'shipping.baseFee': 'Taxa base',
    'shipping.estDelivery': 'Entrega estimada',
    'shipping.yourZone': 'Sua zona',
    'shipping.free': 'Grátis',
    'shipping.note': '* As taxas podem variar conforme peso e dimensões. Frete grátis na Polinésia Francesa.',
    'location.detected': 'Envio para',
    'location.shipping': 'Frete estimado',
    'manager.title': 'Gestão do Catálogo',
    'manager.add': 'Adicionar produto',
    'manager.reset': 'Reiniciar',
    'manager.image': 'Imagem',
    'manager.name': 'Nome',
    'manager.category': 'Categoria',
    'manager.price': 'Preço',
    'manager.actions': 'Ações',
    'form.addTitle': 'Adicionar produto',
    'form.editTitle': 'Editar produto',
    'form.productName': 'Nome do produto',
    'form.productNamePlaceholder': 'Ex: Lágrima da Lagoa',
    'form.category': 'Categoria',
    'form.price': 'Preço',
    'form.image': 'Imagem do produto',
    'form.upload': 'Carregar',
    'form.url': 'URL',
    'form.uploadHint': 'Clique para selecionar uma imagem',
    'form.maxSize': 'Máx 6MB',
    'form.description': 'Descrição',
    'form.descriptionPlaceholder': 'Descrição da joia...',
    'form.cancel': 'Cancelar',
    'form.save': 'Salvar',
    'form.add': 'Adicionar',
    'form.imageRequired': 'Por favor, adicione uma imagem',
    'form.imageTypeError': 'Por favor, selecione uma imagem',
    'form.imageSizeError': 'Imagem muito grande (máx 6MB)',
    'form.storageError': 'Armazenamento cheio. Tente uma imagem mais leve.',
    'form.genericError': 'Não foi possível adicionar o produto. Tente novamente.',
    'form.added': 'Produto adicionado com sucesso',
    'form.updated': 'Produto atualizado',
    'form.deleted': 'Produto excluído',
    'form.resetConfirm': 'Reiniciar catálogo?',
    'form.resetDone': 'Catálogo reiniciado',
    'form.deleteConfirm': 'Excluir este produto?',
    'product.1.description': 'Pingente de pérola do Taiti solitária, 10mm, montado em ouro branco 18k.',
    'product.2.description': 'Par de pérolas barrocas com reflexos berinjela, ganchos em ouro amarelo.',
    'product.3.description': 'Pulseira de couro com múltiplas pérolas, fecho em prata maciça.',
    'product.4.description': 'Pérola negra perfeita de 11mm em anel pavê de diamantes.',
    'product.5.description': 'Fio de pérolas multicoloridas (cinza, verde, pavão), fecho invisível.',
    'product.6.description': 'Pérolas Keshi douradas, design minimalista e moderno.',
  },
  nl: {
    'nav.collections': 'Collecties',
    'nav.story': 'Ons Verhaal',
    'nav.workshop': 'Atelier',
    'nav.cart': 'Winkelwagen',
    'hero.tagline': 'Authenticiteit & Luxe',
    'hero.title': 'Elegantie Geboren uit de',
    'hero.titleAccent': 'Diepten',
    'hero.description': 'Ontdek de magie van Tahitiaanse zwarte parels, met passie gekweekt in de kristalheldere wateren van Polynesië.',
    'hero.cta': 'Ontdek de Collectie',
    'hero.discover': 'Ontdek',
    'collections.tagline': 'Onze Creaties',
    'collections.title': 'De Collecties',
    'collections.all': 'Alles',
    'collections.addToCart': 'Toevoegen aan winkelwagen',
    'category.Colliers': 'Kettingen',
    'category.Boucles d\'oreilles': 'Oorbellen',
    'category.Bracelets': 'Armbanden',
    'category.Bagues': 'Ringen',
    'story.tagline': 'Ons Verhaal',
    'story.title': 'De Kunst van de Parel',
    'story.p1': 'Al drie generaties lang kweekt onze familie zwarte parels in de beschermde lagunes van Tuamotu. Elke parel is het resultaat van overgedragen vakmanschap en een passie voor excellentie.',
    'story.p2': 'Onze ambachtslieden selecteren elke parel zorgvuldig om uitzonderlijke sieraden te creëren, waarbij Polynesische traditie wordt gecombineerd met hedendaags design.',
    'story.cta': 'Ontdek ons atelier',
    'testimonials.tagline': 'Getuigenissen',
    'testimonials.title': 'Wat Onze Klanten Zeggen',
    'newsletter.tagline': 'Nieuwsbrief',
    'newsletter.title': 'Blijf op de Hoogte',
    'newsletter.description': 'Ontvang als eerste onze nieuwe collecties en exclusieve aanbiedingen.',
    'newsletter.placeholder': 'Uw email',
    'newsletter.cta': 'Inschrijven',
    'newsletter.success': 'Bedankt voor uw inschrijving!',
    'footer.rights': 'Alle rechten voorbehouden',
    'footer.contact': 'Contact',
    'footer.legal': 'Juridische Kennisgeving',
    'footer.privacy': 'Privacy',
    'cart.title': 'Uw Winkelwagen',
    'cart.empty': 'Uw winkelwagen is leeg',
    'cart.total': 'Totaal',
    'cart.checkout': 'Afrekenen',
    'cart.remove': 'Verwijderen',
    'shipping.title': 'Verzending & Diensten',
    'shipping.worldwide': 'Wereldwijde Verzending',
    'shipping.worldwideDesc': 'Veilige verzending wereldwijd',
    'shipping.certificate': 'Certificaat van Authenticiteit',
    'shipping.certificateDesc': 'Elk stuk met certificaat',
    'shipping.packaging': 'Luxe Verpakking',
    'shipping.packagingDesc': 'Elegante presentatie in premium etui',
    'shipping.baseFee': 'Basisbedrag',
    'shipping.estDelivery': 'Geschatte levering',
    'shipping.yourZone': 'Uw zone',
    'shipping.free': 'Gratis',
    'shipping.note': '* Tarieven kunnen variëren afhankelijk van gewicht en afmetingen. Gratis verzending in Frans-Polynesië.',
    'location.detected': 'Verzending naar',
    'location.shipping': 'Geschatte verzendkosten',
    'manager.title': 'Catalogusbeheer',
    'manager.add': 'Product toevoegen',
    'manager.reset': 'Herstellen',
    'manager.image': 'Afbeelding',
    'manager.name': 'Naam',
    'manager.category': 'Categorie',
    'manager.price': 'Prijs',
    'manager.actions': 'Acties',
    'form.addTitle': 'Product toevoegen',
    'form.editTitle': 'Product bewerken',
    'form.productName': 'Productnaam',
    'form.productNamePlaceholder': 'Bijv: Lagunetraan',
    'form.category': 'Categorie',
    'form.price': 'Prijs',
    'form.image': 'Productafbeelding',
    'form.upload': 'Uploaden',
    'form.url': 'URL',
    'form.uploadHint': 'Klik om een afbeelding te selecteren',
    'form.maxSize': 'Max 6MB',
    'form.description': 'Beschrijving',
    'form.descriptionPlaceholder': 'Sieraad beschrijving...',
    'form.cancel': 'Annuleren',
    'form.save': 'Opslaan',
    'form.add': 'Toevoegen',
    'form.imageRequired': 'Voeg een afbeelding toe',
    'form.imageTypeError': 'Selecteer een afbeelding',
    'form.imageSizeError': 'Afbeelding te groot (max 6MB)',
    'form.storageError': 'Opslag vol. Probeer een lichtere afbeelding.',
    'form.genericError': 'Kan product niet toevoegen. Probeer opnieuw.',
    'form.added': 'Product succesvol toegevoegd',
    'form.updated': 'Product bijgewerkt',
    'form.deleted': 'Product verwijderd',
    'form.resetConfirm': 'Catalogus herstellen?',
    'form.resetDone': 'Catalogus hersteld',
    'form.deleteConfirm': 'Dit product verwijderen?',
    'product.1.description': 'Solitaire Tahiti-parelhanger, 10mm, gezet in 18k witgoud.',
    'product.2.description': 'Paar barokparels met aubergine reflecties, geel gouden haken.',
    'product.3.description': 'Leren armband met meerdere parels, massief zilveren sluiting.',
    'product.4.description': 'Perfecte 11mm zwarte parel op diamant-pavé ring.',
    'product.5.description': 'Streng meerkleurige parels (grijs, groen, pauw), onzichtbare sluiting.',
    'product.6.description': 'Gouden Keshi-parels, minimalistisch en modern ontwerp.',
  },
};

export const LocaleProvider = ({ children }: { children: ReactNode }) => {
  const [countryCode, setCountryCode] = useState('PF');
  const [locale, setLocale] = useState<Locale>('fr');
  const [config, setConfig] = useState<LocaleConfig>(localeConfigs.default);

  // Detect country on mount
  useEffect(() => {
    const detectCountry = async () => {
      try {
        const res = await fetch('https://ipapi.co/json/');
        const data = await res.json();
        const code = data.country_code || 'PF';
        setCountryCode(code);
        const cfg = localeConfigs[code] || localeConfigs.default;
        setConfig(cfg);
        setLocale(cfg.locale);
      } catch {
        // Keep defaults (Polynesia)
      }
    };
    detectCountry();
  }, []);

  // Update config when locale changes manually
  useEffect(() => {
    setConfig(prev => ({ ...prev, locale }));
  }, [locale]);

  const formatPrice = (priceXPF: number): string => {
    const converted = Math.round(priceXPF * config.exchangeRate);
    if (config.currency === 'XPF') {
      return `${converted.toLocaleString('fr-FR')} XPF`;
    }
    if (config.currency === 'EUR') {
      return `${converted.toLocaleString('fr-FR')} €`;
    }
    return `$${converted.toLocaleString('en-US')}`;
  };

  const t = (key: string): string => {
    return translations[locale]?.[key] || translations['fr'][key] || key;
  };

  return (
    <LocaleContext.Provider
      value={{
        locale,
        setLocale,
        currency: config.currency,
        currencySymbol: config.currencySymbol,
        formatPrice,
        t,
        countryCode,
      }}
    >
      {children}
    </LocaleContext.Provider>
  );
};

export const useLocale = () => {
  const context = useContext(LocaleContext);
  if (!context) {
    throw new Error('useLocale must be used within a LocaleProvider');
  }
  return context;
};
